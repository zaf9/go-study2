# Go-Study2 日志系统配置文件
# 系统采用 GoFrame glog 接口，底层重定向至 slog + lumberjack 引擎以实现高度稳定的日志滚动与并发管理。

logger:
  # ==========================================
  # 全局属性配置
  # ==========================================

  # 全局默认日志级别 (string)
  # 可选值：all(所有), debug(调试), info(正常), notice(提示), warn(警告), error(错误), critical(严重)
  # 实例未配置级别时，将继承此设置。
  level: "all"

  # 全局控制台输出控制 (bool)
  # 是否默认将日志同时输出到终端标准输出 (Stdout)。
  stdout: true

  # 日志时间显示格式 (string)
  # 遵循 Go time 格式。推荐使用 ISO 8601/RFC 3339 兼容格式以适配日志分析系统。
  timeFormat: "2006-01-02T15:04:05.000Z07:00"

  # 结构化上下文键名提取 (slice of string)
  # 系统会自动从 context.Context 中尝试提取这些 Key 的值并记录在日志字段中。
  # 常用：TraceId (链路追踪), UserId (用户标识)。
  ctxKeys: ["TraceId", "UserId"]

  # ==========================================
  # 日志实例配置：按业务功能拆分不同输出流
  # ==========================================

  # 1. 应用主日志 (Application Main Log)
  # 记录业务流程、系统启动及普通操作。
  app:
    # 存储目录
    path: "logs"
    # 文件名模板 (支持日期占位符 {Y-m-d})
    # 物理滚动目前由 lumberjack 托管，文件名中的占位符在适配层会自动处理。
    file: "app-{Y-m-d}.log"
    # 输出格式 (json 或 text)
    # json 格式会自动记录 TraceID, Level 等字段为顶级 key，适合 ELK/Loki 采集。
    format: "json"
    # 实例级别，设为 all 以捕获开发阶段的所有细节
    level: "all"
    # 是否输出到终端控制台 (覆盖全局 stdout 设置)
    stdoutPrint: false

    # --- 日志滚动与自动清理配置 (基于 lumberjack 实现) ---

    # 单个日志文件最大容量。达到此大小将自动触发翻滚 (Rotate)
    # 单位支持：M (MB), G (GB), K (KB)。示例："100M"
    rotateSize: "100M"

    # 历史日志最长保留天数 (int)。超过此时间的旧日志将被后台清理
    # 单位示例："30d" (30天)
    rotateExpire: "30d"

    # 旧日志文件保留的最大个数限制。0 表示不限制，基于文件数量维度进行清理
    rotateBackupLimit: 10

    # 备份文件的过期检查。与 rotateExpire 逻辑类似。
    rotateBackupExpire: "30d"

  # 2. 访问日志 (Access Log)
  # 记录所有入站 HTTP 请求的详细路径、参数、响应状态码及耗时。
  access:
    # 存储路径
    path: "logs/access"
    # 文件名
    file: "access-{Y-m-d}.log"
    # 输出格式
    format: "json"
    # 日志级别
    level: "info"
    # 是否打印到终端
    stdoutPrint: false

  # 3. 错误日志 (Error Log)
  # 专门存放 Error 级别及以上的异常信息，便于通过独立文件快速排查线上问题。
  error:
    # 存储路径
    path: "logs/error"
    # 文件名
    file: "error-{Y-m-d}.log"
    # 输出格式
    format: "json"
    # 日志级别
    level: "error"
    # 是否打印到终端
    stdoutPrint: false

  # 4. 慢查询/慢操作日志 (Slow Operation Log)
  # 用于记录数据库 SQL 执行超过阈值或业务逻辑执行过慢的操作。
  slow:
    # 存储路径
    path: "logs/slow"
    # 文件名
    file: "slow-{Y-m-d}.log"
    # 输出格式
    format: "json"
    # 日志级别
    level: "warning"
    # 是否打印到终端
    stdoutPrint: false
