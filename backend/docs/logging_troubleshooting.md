# 日志故障排查指南

本指南用于快速定位与解决日志系统常见问题（中文说明）。

1. 未看到访问日志
   - 检查 `backend/configs` 中的配置文件，确认 `logger.access.path` 指向正确目录。
   - 确认应用中间件已注册（`main.go` 中是否调用 `middleware.AccessLog`）。
   - 检查日志进程是否有写权限（目录权限、磁盘空间）。

2. 日志格式不正确或时间戳异常
   - 检查 `logger.timeFormat` 配置项是否设置为期望格式。
   - 确认所有生成日志的组件使用了统一的 TimeFormat() 接口。

3. 慢查询未记录
   - 检查数据库慢查询阈值配置（`database.slow.threshold`），确认阈值合理。
   - 确认 DB hook 已注册（检查 `db_logging.RegisterDBLogging` 在数据库初始化时被调用）。

4. 日志文件增长过快
   - 检查分割 (rotate) 策略与保留配置。
   - 临时措施：禁用部分 DEBUG 级别日志或调整采样策略。

5. 敏感数据泄露风险
   - 在日志记录之前对参数进行脱敏；如遇疑似泄露，尽快从日志中删除敏感条目并修复记录逻辑。

6. 日志查询性能慢
   - 对大文件使用流式读取并限制最大匹配数（已实现），如需更高性能，考虑引入日志聚合平台。

7. 无法定位问题
   - 将相关日志截取并附上 TraceID 和时间范围，便于关联分析。
